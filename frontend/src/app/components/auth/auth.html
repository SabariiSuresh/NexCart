<p-toast></p-toast>

<p-dialog [(visible)]="showDialog" [modal]="true" [closable]="true" [dismissableMask]="true" [draggable]="false"
  [resizable]="false" [style]="{width: '450px'}" [breakpoints]="{'640px': '90vw', '768px': '70vw', '1024px': '90vw'}"
  appendTo="body">

  <ng-template pTemplate="header">
    <h3 class="text-5xl font-mono font-semibold text-center w-full m-1 mt-3">
      {{ isLogin ? 'Login' : 'Register' }}
    </h3>
  </ng-template>

  <div *ngIf="isLogin" class="flex flex-col items-center  w-full">
    <form [formGroup]="loginForm" (ngSubmit)="onLogin()" class="w-full">
      <div class="mb-4">
        <label>Email</label>
        <input pInputText formControlName="email" type="email" class="w-full mt-1" placeholder="Enter email" />
        <small class="p-error" *ngIf="loginForm.get('email')?.touched && loginForm.get('email')?.hasError('required')">
          <p class="text-red-400 m-2">Email is required</p>
        </small>
        <small class="p-error" *ngIf="loginForm.get('email')?.hasError('email')">
          <p class="text-red-400 m-2">Invalid email format</p>
        </small>
      </div>

      <div class="mb-4 pb-4">
        <label>Password</label>
        <p-password formControlName="password" [feedback]="false" [toggleMask]="true" class="w-full mt-1"
          inputStyleClass="w-full p-2 rounded bg-gray-700 text-white" placeholder="Enter password">
        </p-password>
        <small class="p-error"
          *ngIf="loginForm.get('password')?.touched && loginForm.get('password')?.hasError('required')">
          <p class="text-red-400 m-2">Password is required</p>
        </small>
      </div>

      <button pButton type="submit" label="Login" icon="pi pi-sign-in" class="w-full"
        [disabled]="loginForm.invalid"></button>
    </form>
  </div>


  <div *ngIf="!isLogin" class="flex flex-col items-center  w-full">
    <form [formGroup]="registerForm" (ngSubmit)="onRegister()" class="w-full">
      <div class="mb-4">
        <label>Name</label>
        <input pInputText formControlName="name" type="text" class="w-full mt-1" placeholder="Enter name" />
        <small class="p-error"
          *ngIf="registerForm.get('name')?.touched && registerForm.get('name')?.hasError('required')">
          <p class="text-red-400 m-2">Name is required</p>
        </small>
        <small class="p-error" *ngIf="registerForm.get('name')?.hasError('minlength')">
          <p class="text-red-400 m-2">Name should be 4 characters</p>
        </small>
      </div>

      <div class="mb-4">
        <label>Email</label>
        <input pInputText formControlName="email" type="email" class="w-full mt-1" placeholder="Enter email" />
        <small class="p-error"
          *ngIf="registerForm.get('email')?.touched && registerForm.get('email')?.hasError('required')">
          <p class="text-red-400 m-2">Email is required</p>
        </small>
        <small class="p-error" *ngIf="registerForm.get('email')?.hasError('pattern')">
          <p class="text-red-400 m-2">Invalid email format</p>
        </small>
      </div>

      <div class="mb-4 pb-4">
        <label>Password</label>
        <p-password formControlName="password" [toggleMask]="true" class="w-full mt-1"
          inputStyleClass="w-full p-2 rounded bg-gray-700 text-white" placeholder="Enter password">

        </p-password>
        <small class="p-error"
          *ngIf="registerForm.get('password')?.touched && registerForm.get('password')?.hasError('required')">
          <p class="text-red-400 m-2">Password is required</p>
        </small>
        <small class="p-error" *ngIf="registerForm.get('password')?.hasError('minlength')">
          <p class="text-red-400 m-2">Minimum 6 characters</p>
        </small>
      </div>

      <button pButton type="submit" label="Register" icon="pi pi-user-plus" class="w-full"
        [disabled]="registerForm.invalid"></button>
    </form>
  </div>

  <ng-template pTemplate="footer">
    <div class="flex justify-center items-center mb-1 w-full">
      <p class="text-sm text-center">
        {{ isLogin ? "Don't have an account?" : "Already have an account?" }}
        <a class="text-blue-400 cursor-pointer" (click)="toggleMode()">
          {{ isLogin ? 'Register' : 'Login' }}
        </a>
      </p>
    </div>
  </ng-template>

</p-dialog>