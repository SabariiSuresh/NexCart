<div class="p-4 bg-gray-100 min-h-screen w-full overflow-hidden text-black">

    <h2 class="font-bold text-5xl pb-7 pt-1 text-left">Manage Orders</h2>

    <p-table [value]="orders" class="shadow-lg rounded-lg overflow-hidden" [rows]="10" [paginator]="true"
        [rowsPerPageOptions]="[5, 10, 20]" [rows]="10" [responsiveLayout]="'scroll'" selectionMode="single">

        <ng-template pTemplate="header">
            <tr class="bg-gray-100 text-gray-800 font-semibold">
                <th>Order Id</th>
                <th>Product</th>
                <th>Quantity</th>
                <th>Customer</th>
                <th>Total</th>
                <th>Delivery Status</th>
                <th>Payment</th>
                <th>Date</th>
                <th>Action</th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-order>
            <tr class="hover:bg-gray-200">
                <td> {{order._id}} </td>
                <td>
                    <ul class="list-disc pl-5">
                        <ol *ngFor="let item of order.orderItems"><strong>{{item.name}}</strong></ol>
                    </ul>
                </td>
                <td>
                    <ul class="list-disc pl-5">
                        <ol *ngFor="let item of order.orderItems">{{item.qty}}</ol>
                    </ul>
                </td>
                <td> {{order.user?.name || 'N/A'}} </td>
                <td> {{order.totalPrice | currency :'INR'}} </td>
                <td>
                    <p-select [options]="statuses" optionLabel="label" optionValue="value" [(ngModel)]="order.status"
                        (onChange)="updateDeliverystatus(order._id , $event.value)" class="w-64" appendTo="body">
                    </p-select>
                </td>
                <td>
                    <span [ngClass]="order.isPaid ? 'text-green-400 font-semibold' : 'text-red-500 font-semibold'  ">
                        {{order.isPaid ? 'Paid' : 'Not Paid'}}
                    </span>
                </td>
                <td> {{order.createdAt |date : 'EEE MMM d , y' }} </td>

                <td>
                    <div class="flex justify-between gap-2">
                        <p-button label="Cancel" (onClick)="cancelOrder($event,order._id)" icon="pi pi-stop-circle"
                            severity="warn" variant="text" [disabled]="order.status === 'delivered'"></p-button>
                        <p-button label="Delete" (onClick)="deleteOrder($event ,order._id)" icon="pi pi-trash" severity="danger"
                            variant="text" [disabled]="order.status === 'delivered'"></p-button>
                    </div>
                </td>
            </tr>
        </ng-template>

    </p-table>

    <p-confirmpopup/>
</div>